# AntibioticShortageProject

## Contents

- [Overview](#overview)
- [Repo Contents](#repo-contents)
- [System Requirements](#system-requirements)
- [Installation Guide](#installation-guide)
- [Demo](#demo)
- [Instruction for use](#instruction-for-use)


# Overview

Antibiotic shortages have become frequent worldwide, with potential consequences on bacterial ecology that are not fully understood. Here, we use mathematical modelling to investigate the impact of amoxicillin shortage on pneumococcal resistance and invasive pneumococcal disease (IPD) incidence.

# Repo Contents

- [Script](./Script): R code to generate all the analyses in the manuscript and supplementary
- [Files](./Files): File used in analyses, generated by R codes in Script
- [Figures](./Figures): Figures in the manuscript and supplementary

# System Requirements

## Hardware Requirements

The code has been tested with a computer with the following specs:

RAM: 64 GB  
CPU: 12-cores, 4.10 GHz

## Software Requirements

### OS Requirements

The code has been tested on the following systems:

Windows 11 Professionnel

#### Installing R version 4.3.3 

# Installation Guide


Users should install the following packages, from an `R` terminal:

```
install.packages(c("ggplot2", "readxl", "tidyr", "dplyr", "reshape2", "ggpubr","socialmixr", "RColorBrewer", "rmarkdown", "plotly", "demodelr","forcats", "sf", "rnaturalearth", "rnaturalearthdata", "corrplot","gridExtra", "gridGraphics", "patchwork", "refset", "cowplot","odin"))
```

which will install in about 2 minutes on a machine with the recommended specs.

# Demo and instructions for use

## Script description

- [DeuxAgeHuitResistanceDeuxAntibiosOdin.R](./Script/DeuxAgeHuitResistanceDeuxAntibiosOdin.R): Odin equations to generate all the simulations
- [EstimationOfAntibioticEfficacy.Rmd](./Script/EstimationOfAntibioticEfficacy.Rmd): R code to calibrate antibiotic-induced decolonization rates (Figure S8 and S9)
- [Figure1_ScenariosPresentation.Rmd](./Script/Figure1_ScenariosPresentation.Rmd): R code to simulate the impact of different shortage management strategies on the evolution of antibiotic exposure and pneumococcal resistance (Figure 1 and Figure S1)
- [Figure2and3_RunDifferentShortageLevels.Rmd](./Script/Figure2and3_RunDifferentShortageLevels.Rmd): R code to simulate the relative variation of different shortage levels (Figure 2) and a 1-year impact of a 50% beta-lactam shortage (Figure 3 and Figure S2)
- [Figure4_BestScenarioAccordingMainParameters.Rmd](./Script/Figure4_BestScenarioAccordingMainParameters.Rmd): R code to generate dataframeVariationPNSP_MR_GammaAmox.csv, dataframeVariationPNSP_MR_Lambda.csv, dataframeVariationPNSP_MR_Rcr.csv, and dataframeVariationPNSP_MR_pi.csv and to simulate the recommended antibiotic shortage management strategy depending on the initial conditions (Figure 5 and Figure S4)
- [Figure5_BestScenariosbyCountry.Rmd](./Script/Figure5_BestScenariosbyCountry.Rmd): R code to simulate shortage in 20 European countries (Figure 6, Figure S7) and to construct the correlation matrix between initial conditions on country-specific pharmaco-epidemiological context (Figure S6)
- [ParametersEstimation.Rmd](./Script/ParametersEstimation.Rmd): R code to calibrate transmission parameters 
- [SensitivityAnalysis_Theta.Rmd](./Script/SensitivityAnalysis_Theta.Rmd): R code to simulate a sensitivity analysis of competition parameter (Figure S5)
- [SensitivityAnlaysis_PRCC.Rmd](./Script/SensitivityAnlaysis_PRCC.Rmd): R code to simulate multivariate sensitivity analysis (Figure S3)
- [SigmoidReductionFunction.R](./Script/SigmoidReductionFunction.R): R code to plot amoxicillin treatment induced decolonization rate for different shortage level (Figure S10)
- [UncertaintyAnalysis0to100LevelsOfShortage.R](./Script/UncertaintyAnalysis0to100LevelsOfShortage.R): R code to generate fichierCombine070225_0to100.csv
- [UncertaintyAnalysisFigure1.R](./Script/UncertaintyAnalysisFigure1.R): R code to generate fichierCombine070225_figure1.csv
- [UncertaintyAnalysisMinMaxMean.R](./Script/UncertaintyAnalysisMinMaxMean.R): R code to generate fichierCombine070225MaxMinMean.csv

A few minutes to run the code with the recommended specs

## Instructions to run on data
[Figure1_ScenariosPresentation.Rmd](./Script/Figure1_ScenariosPresentation.Rmd) R code calls the file [fichierCombine070225_figure1.csv](./Files/fichierCombine070225_figure1.csv)

[Figure2and3_RunDifferentShortageLevels.Rmd](./Script/Figure2and3_RunDifferentShortageLevels.Rmd) R code calls the files [fichierCombine070225_0to100.csv](./Files/fichierCombine070225_0to100.csv) and [fichierCombine070225MaxMinMean.csv](./Files/fichierCombine070225MaxMinMean.csv)

[Figure4_BestScenarioAccordingMainParameters.Rmd](./Script/Figure4_BestScenarioAccordingMainParameters.Rmd): R code calls the files [dataframeVariationPNSP_MR_GammaAmox.csv](./Files/dataframeVariationPNSP_MR_GammaAmox.csv), [dataframeVariationPNSP_MR_Lambda.csv](./Files/dataframeVariationPNSP_MR_Lambda.csv), [dataframeVariationPNSP_MR_Rcr.csv](./Files/dataframeVariationPNSP_MR_Rcr.csv), and [dataframeVariationPNSP_MR_pi.csv](./Files/dataframeVariationPNSP_MR_pi.csv)

[Figure5_BestScenariosbyCountry.Rmd](./Script/Figure5_BestScenariosbyCountry.Rmd) calls the file [DataframeParametresPays.xlsx](./Files/DataframeParametresPays.xlsx)


